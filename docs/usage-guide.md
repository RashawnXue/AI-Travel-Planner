# 使用指南

## 我的行程页面功能说明

### 页面布局

我的行程页面采用经典的两栏布局：

- **左侧栏**：行程列表，展示所有已创建的行程
- **右侧区域**：行程详情，展示选中行程的完整信息

### 功能说明

#### 1. 行程列表

**位置**：页面左侧，固定宽度 320px

**功能**：
- 展示当前用户的所有行程，按创建时间倒序排列
- 支持下拉加载更多（每页20条）
- 点击行程卡片查看详情
- 右键（或长按）行程卡片显示操作菜单

**行程卡片信息**：
- 行程标题（最多显示2行）
- 目的地和天数
- 出发日期
- 预算金额
- 创建时间（相对时间，如"3天前"）

**操作**：
- **查看详情**：点击卡片
- **删除行程**：右键菜单 → 删除（需确认）

**侧边栏折叠**：
- 点击左上角折叠按钮可隐藏侧边栏
- 移动端默认折叠
- 折叠后显示展开按钮

#### 2. 行程详情

**概览区域**：
- 行程标题和概述
- 基本信息网格：
  - 目的地
  - 行程天数
  - 出发日期
  - 预算金额
  - 同行人数
  - 旅行偏好

**Tab 导航**：
1. **每日行程**
   - 左侧：日期选择器
   - 右侧：时间轴展示活动
   - 每个活动包含：
     - 时间
     - 活动名称
     - 地点和地址
     - 时长和费用
     - 活动描述
     - 温馨提示（如有）
   - 底部显示当日预计花费
   - 导航按钮：点击可在移动设备上打开地图导航

2. **住宿安排**
   - 按天展示推荐酒店
   - 酒店信息：
     - 酒店名称
     - 地址
     - 价格区间
     - 评分
     - 推荐理由
   - 查看地图：点击可在移动设备上打开地图

3. **交通信息**
   - 交通概述
   - 详细交通方案列表：
     - 交通类型（飞机/火车/地铁/公交）
     - 路线描述
     - 预计费用
   - 底部显示交通费用总计

4. **费用预算**
   - 预算总览（圆形进度图）：
     - 显示已规划费用
     - 占总预算百分比
     - 颜色指示：
       - 蓝色：< 80%
       - 橙色：80% - 100%
       - 红色：> 100%
   - 费用明细（条形图）：
     - 交通
     - 住宿
     - 餐饮
     - 活动
     - 购物
     - 其他
   - 支出记录表格：
     - 日期时间
     - 分类
     - 描述
     - 金额
     - 操作（删除）
   - 添加支出记录按钮

#### 3. 添加支出记录

**触发方式**：点击"费用预算" Tab 中的"添加支出记录"按钮

**表单字段**：
1. **支出分类**（必填）
   - 选项：交通、住宿、餐饮、活动、购物、其他

2. **支出金额**（必填）
   - 最小值：0
   - 精度：2位小数
   - 前缀：¥

3. **支出描述**（可选）
   - 最大长度：200字符

4. **支出日期**（必填）
   - 格式：YYYY-MM-DD
   - 限制：在行程日期范围内

5. **支出时间**（必填）
   - 格式：HH:mm

**提交**：
- 验证所有必填字段
- 保存到数据库
- 自动刷新支出列表和统计数据

#### 4. 删除支出记录

**操作**：点击支出记录表格中的"删除"按钮

**流程**：
1. 弹出确认对话框
2. 确认后从数据库删除
3. 自动刷新支出列表和统计数据

### 响应式设计

**移动端适配**（屏幕宽度 < 768px）：
- 侧边栏默认折叠
- 概览区域垂直排列
- 每日行程的日期列表改为横向滚动
- 内容区域占满全屏

**平板端适配**（768px - 1279px）：
- 侧边栏可折叠
- 内容区域自适应

**桌面端**（≥ 1280px）：
- 完整布局
- 充分利用宽屏空间

### 数据加载

**初始加载**：
1. 加载行程列表
2. 自动选中第一个行程（或URL中指定的行程）
3. 加载选中行程的详情

**分页加载**：
- 滚动到列表底部自动加载下一页
- 每页20条记录
- 显示加载状态

**切换行程**：
- 点击行程卡片
- 更新URL参数（不刷新页面）
- 加载新行程的详情

**切换Tab**：
- 切换到"费用预算"Tab时自动加载支出记录
- 其他Tab使用行程详情中的数据

### 错误处理

**空状态**：
- 无行程：显示友好提示和创建入口
- 行程不存在：显示"行程不存在或已被删除"

**加载失败**：
- 显示错误提示
- 提供重试选项

**操作失败**：
- 显示具体错误信息
- 保持当前状态不变

### 用户体验优化

1. **加载状态**
   - 列表加载：显示Spin + 提示文字
   - 详情加载：全屏Spin
   - 分页加载：底部小型Spin

2. **交互反馈**
   - 卡片悬停：背景色变化 + 左侧边框
   - 按钮悬停：颜色加深
   - 操作成功：显示成功提示
   - 操作失败：显示错误提示

3. **确认对话框**
   - 删除行程：需要确认
   - 删除支出：需要确认
   - 退出登录：需要确认

4. **数据持久化**
   - 所有数据存储在Supabase
   - 自动同步到云端
   - 支持跨设备访问

## 注意事项

1. **权限**
   - 所有行程和支出数据都是用户私有的
   - 启用了行级安全策略（RLS）
   - 无法访问其他用户的数据

2. **数据安全**
   - 所有API调用都经过身份验证
   - Token自动刷新
   - 未登录自动跳转到登录页

3. **浏览器兼容**
   - 推荐使用Chrome 90+、Safari 14+、Firefox 88+
   - 不支持IE浏览器

4. **网络要求**
   - 所有功能需要网络连接
   - 不支持离线使用

## 常见问题

**Q: 如何创建新行程？**  
A: 点击左侧栏顶部的"创建新行程"按钮，或导航栏中的"创建行程"链接。（注：该功能暂未实现）

**Q: 如何编辑行程？**  
A: 编辑功能即将开放，目前只能查看和删除行程。

**Q: 支出记录可以修改吗？**  
A: 目前只能删除后重新添加。

**Q: 导航功能在PC上无法使用？**  
A: 导航功能针对移动设备优化，建议在手机上使用。PC上会显示地址信息供手动搜索。

**Q: 数据会丢失吗？**  
A: 所有数据都存储在云端，不会丢失。即使清除浏览器缓存，重新登录后数据依然存在。

